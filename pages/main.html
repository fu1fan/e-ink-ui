<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./src/bootstrap.min.css">
    <link rel="stylesheet" href="./src/paper.css">
    <link rel="stylesheet" href="./src/css/font-awesome.min.css">
    <title>主界面</title>
</head>

<body>
    <div class="text-center head-fixed-top">
        <span id="net"></span>&emsp;<span id="time">00:00</span>&emsp;@xuanzhi33
    </div>
    <div class="container text-center mt-4">
        <div class="mb-1">
            <button id="reader"><i class="fa fa-book" aria-hidden="true"></i> 阅读</button>
            <button id="weather"><i class="fa fa-cloud" aria-hidden="true"></i> 天气</button>
            <button id="clock"><i class="fa fa-clock-o" aria-hidden="true"></i> 时钟</button>
        </div>
        <div class="mb-1">
            <button id="date"><i class="fa fa-calendar" aria-hidden="true"></i> 日期钟</button>
            <button id="tomato"><i class="fa fa-hourglass" aria-hidden="true"></i> 番茄钟</button>
            <button id="yiyan"><i class="fa fa-sticky-note-o" aria-hidden="true"></i> 一言</button>
        </div>
        <div class="mb-1">
            <button id="calc"><i class="fa fa-calculator" aria-hidden="true"></i> 计算器</button>
            <button id="random"><i class="fa fa-random" aria-hidden="true"></i> 随机数生成器</button>
        </div>
        <div class="mb-1">
            <button id="note"><i class="fa fa-file" aria-hidden="true"></i> 记事本</button>
            <button id="testpage"><i class="fa fa-code" aria-hidden="true"></i> 测试页</button>
            <button id="refresh"><i class="fa fa-refresh" aria-hidden="true"></i> 刷新</button>
        </div>
        <div class="mb-1">
            <button id="settings"><i class="fa fa-wrench" aria-hidden="true"></i> 系统设置</button>
            <button id="terminal"><i class="fa fa-terminal" aria-hidden="true"></i> 终端</button>
            <button id="power"><i class="fa fa-power-off" aria-hidden="true"></i> 电源</button>
        </div>
    </div>

    <script src="./src/jquery.min.js"></script>
    <script src="./src/piapi.js"></script>
    <script>
        function upd() {
            piapi.updateImage()
        }

        function updateTime() {
            var date = new Date();
            var h = date.getHours();
            var m = date.getMinutes();
            //auto add 0
            h = h < 10 ? '0' + h : h;
            m = m < 10 ? '0' + m : m;
            var time = h + ":" + m;

            if (time != $("#time").text()) {
                $("#time").text(time);
                upd();
            }
        }

        var date = new Date();
        var h = date.getHours();
        var m = date.getMinutes();
        //auto add 0
        h = h < 10 ? '0' + h : h;
        m = m < 10 ? '0' + m : m;
        var time = h + ":" + m;
        $("#time").text(time);

        setInterval(updateTime, 5000);

        $("#refresh").click(function () {
            location.href = "./main.html?refresh=1";
        });

        $("#upda").click(function () {
            piapi.refreshScreen();
        });

        $("#reader").click(function () {
            location.href = "./reader.html"
        })

        function GetUrlByParamName(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var URL = decodeURI(window.location.search);
            var r = URL.substr(1).match(reg);
            if (r != null) {
                //decodeURI() 函数可对 encodeURI() 函数编码过的 URI 进行解码  
                return decodeURI(r[2]);
            };
            return null;
        }

        if (GetUrlByParamName("refresh") == "1") {
            upd();
        }

        function whenOnline() {
            $("#net").html('<i class="fa fa-wifi" aria-hidden="true"></i> Online');
        }
        function whenOffline() {
            $("#net").html('× Offline');
        }
        if (navigator.onLine) {
            whenOnline();
        } else {
            whenOffline();
        }
        $(window).on("online", function () {
            whenOnline();
            upd();
        });
        $(window).on("offline", function () {
            whenOffline();
            upd();
        });

        $("#clock").click(function () {
            location.href = "./clock.html";
        })
        $("#weather").click(function () {
            location.href = "./weather.html";
        })
        $("#date").click(function () {
            location.href = "./date.html";
        })
        $("#yiyan").click(function () {
            location.href = "./yiyan.html";
        })
        $("#testpage").click(function () {
            location.href = "./test.html";
        })
        $("#calc").click(function(){
            location.href = "./calc.html";
        })
        $("#random").click(function(){
            location.href = "./random.html";
        })
        $("#note").click(function(){
            location.href = "./note.html";
        })
        $("#terminal").click(function(){
            location.href = "./terminal.html";
        })
        $("#settings").click(function(){
            location.href = "./settings.html";
        })
        $("#about").click(function(){
            location.href = "./about.html";
        })
        $("#power").click(function(){
            location.href = "./power.html";
        })
        $("#tomato").click(function(){
            location.href = "./tomato.html";
        })

        $(window).scroll(upd);
    </script>
</body>

</html>